---
title: "Coseq() Results"
author: "Cassandra Sperow"
date: "2023-10-27"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = TRUE)
library(tidyverse)
```

## Clustering Analysis

```{r}
readRDS("../output/run_kmeans_P2.rds") -> seed23P
readRDS("../output/run_kmeans_P3.rds") -> seed105P
readRDS("../output/run_kmeans_P4.rds") -> seed12P

```


```{r}
summary(seed23P)
summary(seed105P)
summary(seed12P)
```

# Read in cluster assignents info from ```coseq()``` seed experiments
```{r}
read_csv("../output/species_P_cluster_assignments.csv") -> clusters_P
```

### From PCA Results in 'PCA_CLR.Rmd' for species P, were the top contributing ASVs consistently clustered by the coseq() K-means runs?
- Filter starting with the ASVs from the PCA results for Dimension 1 (see: "../output/species_P_pca_ranks.csv" for the list of the top contributing ASVs for species P. Compare here with the cluster assignents from the 3 random runs of K-means via coseq().)
- Yes, filtering for the top-ranked PCs reveals that several are consistently clustered over 3 random runs. Below, the cluster assignments are consistent for 8 out of 10 ASVs that were the highest contributing in the Principal COmponents Analysis for species P. 
- **Conclusion: These bacteria are likely to be found together for species P.** 
```{r}
clusters_P %>% 
  filter(ASV %in% c( "ASV0123", "ASV0057", "ASV0142", "ASV0002", 
                     "ASV0185", "ASV0236", "ASV0059", "ASV0008", 
                     "ASV0058", "ASV0576")) %>% 
  arrange(seed23_run2)
  
```



### Histograms of Clustering Results
```{r}
map(clusters_P[,-1], ~hist(., main = "Histogram of Seed Experiments "))  
```


```{r}
```


```{r}
```

